local p = {}

function p.fn(frame)
    local args = (type(frame.getParent) == "function") and frame:getParent().args or frame

local months = {
    January = 1,
    February = 2,
    March = 3,
    April = 4,
    May = 5,
    June = 6,
    July = 7,
    August = 8,
    September = 9,
    October = 10,
    November = 11,
    December = 12
}

local monthRet = {}
for key, value in pairs(months) do
     table.insert(monthRet, '{{#querylink:{{FULLPAGENAME}}|' .. key .. '|class=item-{{#ifeq:' .. value .. '|{{#if: {{#urlget:month}}|{{#urlget:month}}|{{CURRENTMONTH}} }}||un}}selected|month=' .. value .. '|year={{#if: {{#urlget:year}}|{{#urlget:year}}|{{CURRENTYEAR}} }}|hash={{#urldecode:{{#urlget:hash}}}}|mailbox={{#urlget:mailbox}} }}')
end

local ret = ''
ret = ret .. table.concat(monthRet, " | ")
ret = ret .. ' â€“ '
ret = ret .. '{{#querylink:{{FULLPAGENAME}}|previous year|month={{#if: {{#urlget:month}}|{{#urlget:month}}|{{CURRENTMONTH}} }}|year={{#expr:{{#if: {{#urlget:year}}|{{#urlget:year}}|{{CURRENTYEAR}} }} -1}}|hash={{#urldecode:{{#urlget:hash}}}}|mailbox={{#urlget:mailbox}} }}'
ret = ret .. ' | '
ret = ret .. '{{#querylink:{{FULLPAGENAME}}|next year|month={{#if: {{#urlget:month}}|{{#urlget:month}}|{{CURRENTMONTH}} }}|year={{#expr:{{#if: {{#urlget:year}}|{{#urlget:year}}|{{CURRENTYEAR}} }} +1}}|hash={{#urldecode:{{#urlget:hash}}}}|mailbox={{#urlget:mailbox}} }}'
ret = ret .. ' | '
ret = ret .. '{{#querylink:{{FULLPAGENAME}}|show all|hash={{#urldecode:{{#urlget:hash}}}}|mailbox={{#urlget:mailbox}}|show=all|month=-1|class=item-{{#ifeq:{{#urlget:show}}|all||un}}selected}}'

     return frame:preprocess(ret)
end
-- =p.fn({"add\ndfdd","b","c","text"})
return p

